---
import Logotype from "./Logotype.astro";
import { repoUrl, appUrl } from "../config";

interface NavbarOption {
  name: string;
  href: string;
  icon: string;
}

const navbarOptions: NavbarOption[] = [
  // {
  //   name: "Docs",
  //   href: "/docs",
  //   icon: '<path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path>',
  // },
];
---

<nav
  class="animate-fade-in-down px-16 py-4 bg-gray-900/85 border-b border-blue-700 rounded-xs flex items-center justify-between backdrop-blur-lg transition-all duration-300 ease-out w-full fixed z-50"
>
  <div class="animate-fade-in-left animation-delay-200 flex items-center gap-6">
    <a href="/" class="flex items-center group">
      <Logotype
        className="w-auto h-8 py-2 fill-white transition-all duration-300 group-hover:fill-blue-400"
      />
    </a>
    <div class="hidden lg:flex gap-2">
      {
        navbarOptions.map((option, index) => (
          <a
            href={option.href}
            class={`animate-fade-in-up animation-delay-${400 + index * 100} text-sm font-medium rounded-xs bg-gray-900 text-white hover:bg-gray-800 group relative border border-gray-800 transition-all duration-300 select-none focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 flex items-center gap-2 px-4 py-2`}
          >
            {option.name}
          </a>
        ))
      }
    </div>
  </div>

  <div
    class="animate-fade-in-right animation-delay-300 flex items-center gap-2"
  >
    <div class="hidden lg:flex gap-2 items-center">
      <a
        href={repoUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="animate-fade-in-up animation-delay-700 text-sm font-medium rounded-xs bg-gray-900 text-white hover:bg-gray-800 group relative border border-gray-800 transition-all duration-300 select-none focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 flex items-center gap-2 px-4 py-2"
      >
        <svg
          class="size-3 shrink-0"
          fill="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            d="M12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26ZM12.0006 15.968L16.2473 18.3451L15.2988 13.5717L18.8719 10.2674L14.039 9.69434L12.0006 5.27502L9.96214 9.69434L5.12921 10.2674L8.70231 13.5717L7.75383 18.3451L12.0006 15.968Z"
          ></path>
        </svg>
        Star on GitHub
      </a>

      <a
        href={appUrl}
        class="animate-fade-in-up animation-delay-800 text-sm font-semibold rounded-xs bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 focus:ring-offset-gray-900 transition-all duration-300 select-none flex items-center px-4 py-2"
      >
        Get started
      </a>
    </div>

    <div class="lg:hidden relative">
      <button
        id="mobile-menu-button"
        class="animate-fade-in-scale animation-delay-900 p-2 rounded-xs bg-gray-800/90 text-gray-100 hover:bg-gray-700 hover:text-white focus:ring-2 focus:ring-blue-400 focus:ring-offset-1 focus:ring-offset-gray-900 transition-all duration-300"
        aria-label="Toggle menu"
      >
        <svg
          id="menu-icon"
          class="w-5 h-5 transition-transform duration-300"
          fill="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path d="M3 4H21V6H3V4ZM3 11H21V13H3V11ZM3 18H21V20H3V18Z"></path>
        </svg>
      </button>

      <div
        id="mobile-menu"
        class="hidden absolute right-0 top-full mt-2 w-56 bg-gray-900 border border-gray-600 rounded-xs overflow-hidden shadow-lg z-50"
      >
        <div class="py-1">
          {
            navbarOptions.map((option) => (
              <a
                href={option.href}
                class="mobile-menu-link flex items-center gap-3 px-4 py-3 text-sm font-medium text-white hover:bg-gray-800/80 active:bg-gray-700 transition-all duration-200 border-b border-gray-700/30"
              >
                <svg
                  class="size-4 shrink-0"
                  fill="currentColor"
                  viewBox="0 0 24 24"
                  aria-hidden="true"
                >
                  <Fragment set:html={option.icon} />
                </svg>
                {option.name}
              </a>
            ))
          }

          <a
            href={repoUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="mobile-menu-link flex items-center gap-3 px-4 py-3 text-sm font-medium text-white hover:bg-gray-800/80 active:bg-gray-700 transition-all duration-200 border-b border-gray-700/30"
          >
            <svg
              class="size-4 shrink-0"
              fill="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                d="M12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26ZM12.0006 15.968L16.2473 18.3451L15.2988 13.5717L18.8719 10.2674L14.039 9.69434L12.0006 5.27502L9.96214 9.69434L5.12921 10.2674L8.70231 13.5717L7.75383 18.3451L12.0006 15.968Z"
              ></path>
            </svg>
            Star on GitHub
          </a>

          <div class="px-3 py-2">
            <a
              href={appUrl}
              class="mobile-menu-link block w-full px-4 py-3 text-sm font-semibold bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-200 rounded-xs text-center"
            >
              Get started
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<div
  id="mobile-backdrop"
  class="hidden fixed inset-0 bg-black/50 z-40 lg:hidden"
>
</div>

<style>
  @keyframes fade-in-down {
    from {
      opacity: 0;
      transform: translateY(-30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fade-in-left {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fade-in-right {
    from {
      opacity: 0;
      transform: translateX(30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fade-in-scale {
    from {
      opacity: 0;
      transform: scale(0.8);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes menu-appear {
    from {
      opacity: 0;
      transform: scale(0.95) translateY(-10px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  .animate-fade-in-down {
    animation: fade-in-down 0.3s ease-out forwards;
    opacity: 0;
  }

  .animate-fade-in-left {
    animation: fade-in-left 0.7s ease-out forwards;
    opacity: 0;
  }

  .animate-fade-in-right {
    animation: fade-in-right 0.7s ease-out forwards;
    opacity: 0;
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.5s ease-out forwards;
    opacity: 0;
  }

  .animate-fade-in-scale {
    animation: fade-in-scale 0.5s ease-out forwards;
    opacity: 0;
  }

  .animation-delay-200 {
    animation-delay: 0.2s;
  }
  .animation-delay-300 {
    animation-delay: 0.3s;
  }
  .animation-delay-400 {
    animation-delay: 0.4s;
  }
  .animation-delay-500 {
    animation-delay: 0.5s;
  }
  .animation-delay-700 {
    animation-delay: 0.7s;
  }
  .animation-delay-800 {
    animation-delay: 0.8s;
  }
  .animation-delay-900 {
    animation-delay: 0.9s;
  }

  #mobile-menu:not(.hidden) {
    animation: menu-appear 0.2s ease-out forwards;
  }

  #menu-icon {
    transition: transform 0.3s ease;
  }

  #menu-icon.rotated {
    transform: rotate(90deg);
  }
</style>

<script>
  const menuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");
  const mobileBackdrop = document.getElementById("mobile-backdrop");
  const menuIcon = document.getElementById("menu-icon");
  const menuLinks = document.querySelectorAll(".mobile-menu-link");

  const openIcon =
    '<path d="M3 4H21V6H3V4ZM3 11H21V13H3V11ZM3 18H21V20H3V18Z" />';
  const closeIcon =
    '<path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path>';

  function toggleMenu() {
    const isOpen = !mobileMenu?.classList.contains("hidden");

    if (isOpen) {
      mobileMenu?.classList.add("hidden");
      mobileBackdrop?.classList.add("hidden");
      if (menuIcon) {
        menuIcon.innerHTML = openIcon;
        menuIcon.classList.remove("rotated");
      }
    } else {
      mobileMenu?.classList.remove("hidden");
      mobileBackdrop?.classList.remove("hidden");
      if (menuIcon) {
        menuIcon.innerHTML = closeIcon;
        menuIcon.classList.add("rotated");
      }
    }
  }

  menuButton?.addEventListener("click", toggleMenu);
  mobileBackdrop?.addEventListener("click", toggleMenu);

  menuLinks.forEach((link) => {
    link.addEventListener("click", toggleMenu);
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && !mobileMenu?.classList.contains("hidden")) {
      toggleMenu();
    }
  });
</script>
